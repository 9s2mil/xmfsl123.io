<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <link rel="manifest" href="./manifest.json">
  <link rel="stylesheet" href="plan.css">
  <link rel="stylesheet" href="play.css">
  <meta name="theme-color" content="#ffffff">
  <title>Puzzle and Plan</title>
</head>

<body>

<header id="appHeader" class="app-header">
  <!-- 좌측: 아바타 + 리더 -->
  <div class="hdr-left">
    <div class="avatar" id="headerAvatar" aria-label="프로필 이미지">
      <img src="icons/avatar.png" alt="리더 아바타" class="avatar-img">
    </div>
    <div class="leader" id="headerLeaderText"> </div>
  </div>

  <!-- 우측: 닉네임/랭크/키/케레이 -->
  <div class="hdr-right">
    <div class="row nick">
      <span id="headerNickname">닉네임 설정</span>
      <input id="nickInput" class="nick-input" type="text" maxlength="20" placeholder="닉네임" />
    </div>

    <div class="row meta">
      <span class="label">랭크</span>
      <strong id="headerRank">1</strong>
    </div>

    <div class="row keray">
      <span class="label">케레이</span>
      <strong id="hdrKeray">0</strong>
    </div>

    <div class="row keys">
      <div class="key chip">
        <img class="key-icon" src="icons/key-rose.png" alt="로즈키">
        <strong id="hdrRose">0</strong>
      </div>
      <div class="key chip">
        <img class="key-icon" src="icons/key-silver.png" alt="실버키">
        <strong id="hdrSilver">0</strong>
      </div>
      <div class="key chip">
        <img class="key-icon" src="icons/key-gold.png" alt="골드키">
        <strong id="hdrGold">0</strong>
      </div>
    </div>
  </div>
</header>

  <!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

  <main class="main-container">
    <div class="main-buttons">
      <button class="main-btn" id="btnAdventure">모험</button>
      <button class="main-btn" id="btnCardTeam">팀편성</button>
      <button class="main-btn" id="btnCardList">카드도감</button>
      <button class="main-btn" id="btnOpenSummon" data-popup="summonMain">소환</button>
    </div>
  </main>

  <!-- 모험 전체 화면 -->
<div id="adventureScreen" class="adventure-screen" style="display:none;">

  <!-- 상단 UI -->
  <div class="adventure-header">
    <button class="btn-home">🏠</button>
    <div class="key-count">🔑 <span id="roseKeyCount">0</span></div>
  </div>

  <!-- 적 일러스트 영역 -->
  <div class="enemy-area">
    <div class="enemy-grid">
      <div class="enemy-slot"></div>
      <div class="enemy-slot"></div>
      <div class="enemy-slot"></div>
    </div>
  </div>

  <!-- 아군 카드 영역 -->
  <div class="ally-team">
    <div class="ally-slot"></div>
    <div class="ally-slot"></div>
    <div class="ally-slot"></div>
    <div class="ally-slot"></div>
    <div class="ally-slot"></div>
    <div class="ally-slot"></div>
  </div>

  <!-- HP 바 -->
  <div class="hp-bar">
    <div class="hp-fill" style="width: 100%; height: 1vh;"></div>
  </div>

  <!-- 퍼즐판 -->
  <div class="puzzle-board">
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>

    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>

    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>

    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>

    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
    <div class="puzzle-slot"></div>
  </div>

  <!-- 스킬 게이지 -->
  <div class="skill-gauge">
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
    <div class="skill-segment"></div>
  </div>

</div>

  <!-- 1단계: 카드 - 팀편성 팝업 -->
  <div class="popup" id="CardTeam">
    <div class="popupContent">
      <h2>팀편성</h2>
    </div>
  </div>

  <!-- 1단계: 카드 - 카드도감 팝업 -->
  <div class="popup" id="CardList">
    <div class="popupContent">
      <h2>카드목록</h2>
    </div>
  </div>

  <!-- 1단계: 소환 메인 레이어 -->
  <div class="popup" id="summonMain">
    <div class="popupContent">
      <h2>소환</h2>
      <button class="btn-gate" id="btnGateKerei">케레이 게이트</button>
      <button class="btn-gate" id="btnGateRoseKerei">로즈 케레이 게이트</button>
      <button class="btn-gate" id="btnGateGoldKerei">골든 케레이 게이트</button>
    </div>
  </div>
  
  <!-- 2단계: 케레이 게이트 레이어 -->
  <div class="popup" id="GateKerei">
    <div class="popupContent">
      <h2>케레이 게이트</h2>
      <!-- 케레이 게이트 관련 내용 -->
    </div>
  </div>
  
  <!-- 2단계: 로즈 케레이 게이트 레이어 -->
  <div class="popup" id="GateRoseKerei">
    <div class="popupContent">
      <h2>로즈 케레이 게이트</h2>
      <!-- 로즈 케레이 게이트 관련 내용 -->
    </div>
  </div>
  
  <!-- 2단계: 골든 케레이 게이트 레이어 -->
  <div class="popup" id="GateGoldKerei">
    <div class="popupContent">
      <h2>골든 케레이 게이트</h2>
      <!-- 골든 케레이 게이트 관련 내용 -->
    </div>
  </div>

  <!-- 3단계: 케레이 게이트 팝업 -->
  <div class="popup" id="GateKerei">
    <div class="popupContent">
      <h2>케레이 게이트</h2>
      <!-- 여기에 나중에 콘텐츠 추가 가능 -->
    </div>
  </div>
  
  <!-- 3단계: 로즈 케레이 게이트 팝업 -->
  <div class="popup" id="GateRoseKerei">
    <div class="popupContent">
      <h2>로즈 케레이 게이트</h2>
      <!-- 여기에 나중에 콘텐츠 추가 가능 -->
    </div>
  </div>
  
  <!-- 3단계: 골든 케레이 게이트 팝업 -->
  <div class="popup" id="GateGoldKerei">
    <div class="popupContent">
      <h2>골든 케레이 게이트</h2>
      <!-- 여기에 나중에 콘텐츠 추가 가능 -->
    </div>
  </div>

  <!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
<footer>
  <button data-popup="popup1">✅<br><span class="smft">일일 과제</span></button>
  <button data-popup="popup2">🌱<br><span class="smft">습관</span></button>
  <button data-popup="popup3">🏆<br><span class="smft">목표</span></button>
  <button data-popup="popup4">🎁<br><span class="smft">보상</span></button>
</footer>

  <div class="popup" id="popup1">
    <div class="popupContent">
      <h2>일일 과제</h2><br> <button id="diamond1" class="addbutton">🗡️</button>
      <div class="taskList" data-for="popup1"></div>
    </div>
  </div>

  <div class="popup" id="popup2">
    <div class="popupContent">
      <h2>습관</h2><br> <button id="diamond2" class="addbutton">🗡️</button>
      <div class="taskList" data-for="popup2"></div>
    </div>
  </div>

  <div class="popup" id="popup3">
    <div class="popupContent">
      <h2>목표</h2><br> <button id="diamond3" class="addbutton">🗡️</button>
      <div class="taskList" data-for="popup3"></div>
    </div>
  </div>

  <div class="popup" id="popup4">
    <div class="popupContent"><div class="rewards-wrap" id="rewardsWrap" aria-label="보상 상점">
    <h2>보상</h2><br> <button class="addbutton" id="pointsButton" type="button" aria-disabled="true"><strong id="pointsValue">0</strong></button>
  
    <!-- 1) 로즈키 (브론즈/로즈골드) : 1포인트 = 1개 구매 -->
    <section class="reward-card shop" id="shopRose" data-cost="1" aria-label="로즈키 상점">
      <header class="rc-head">
        <h3>로즈키 <span class="icon" aria-hidden="true">✭</span></h3>
        <button type="button" class="btn-buy" id="buyRoseBtn" aria-label="로즈키 1개 구매 (1포인트)">
          구매
        </button>
      </header>
    </section>

    <!-- 2) 실버키 : 조건형 (로즈키 10개당 1회 구매 가능) -->
    <section class="reward-card shop" id="shopSilver" data-unlock-by="rose" data-unlock-step="10" data-cost="1" aria-label="실버키 상점">
      <header class="rc-head">
        <h3>실버키 <span class="icon" aria-hidden="true">🗝️</span></h3>
        <button type="button" class="btn-buy" id="buySilverBtn" disabled>획득</button>
      </header>
    </section>
        
    <!-- 3) 골드키 : 보상형 (실버키 10개당 자동 1개 지급) -->
    <section class="reward-card shop" id="shopGold" data-reward-by="silver" data-reward-step="10" aria-label="골드키 보상">
      <header class="rc-head">
        <h3>골드키 <span class="icon" aria-hidden="true">🔑</span></h3>
        <button type="button" class="btn-buy" id="buyGoldBtn" disabled>획득</button>
      </header>
    </section>
    
    </div></div>
  </div>

  <!-- ===== 입력 스크린 ===== -->
  <div class="screen" id="taskScreen" aria-hidden="true">
    <div class="screen-backdrop"></div>
  
    <div class="screen-panel" role="dialog" aria-modal="true" aria-labelledby="screenTitle">
      <div class="screen-head">
        <h3 id="screenTitle">할 일 추가</h3>
      </div>
  
      <form id="taskForm" class="screen-body">
        <!-- 제목 -->
        <label class="field">
          <span class="label">제목</span>
          <input type="text" name="title">
        </label>
  
        <!-- 설명 -->
        <label class="field">
          <span class="label">설명</span>
          <textarea name="desc" rows="3"></textarea>
        </label>
  
        <!-- 난이도 -->
        <div class="field">
          <span class="label">난이도</span>
          <div class="stars" role="group" aria-label="난이도 선택">
            <button type="button" class="star" data-star="1">1성</button>
            <button type="button" class="star" data-star="2">2성</button>
            <button type="button" class="star" data-star="3">3성</button>
            <button type="button" class="star" data-star="4">4성</button>
          </div>
          <input type="hidden" name="difficulty" value="1">
        </div>
  
        <!-- 날짜 -->
        <label class="field">
          <span class="label">날짜</span>
          <input type="date" name="date">
        </label>
  
        <!-- 태그 -->
        <label class="field">
          <span class="label">태그</span>
          <input type="text" name="tags">
        </label>
  
        <input type="hidden" name="mode" value="create">
        <input type="hidden" name="editId" value="">

        <!-- 액션 버튼 영역 -->
        <div class="actions">
          <button type="button" class="btn-secondary" id="screenCancel">취소</button>
          <button type="submit" class="btn-primary">저장</button>
        </div>

      </form>
    </div>
  </div>

  <script src="plan.js"></script>
  <script src="play.js"></script>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./service-worker2.js', { scope: './' });
  }
  </script>

</body>

</html>